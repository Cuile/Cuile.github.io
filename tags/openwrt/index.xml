<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>OpenWRT on 瘦了就帅了</title><link>https://blog.cuile.com/tags/openwrt/</link><description>Recent content in OpenWRT on 瘦了就帅了</description><generator>Hugo -- gohugo.io</generator><language>zh-CN</language><lastBuildDate>Mon, 07 Feb 2022 13:37:19 +0800</lastBuildDate><atom:link href="https://blog.cuile.com/tags/openwrt/index.xml" rel="self" type="application/rss+xml"/><item><title>OpenWRT 配置透明代理</title><link>https://blog.cuile.com/posts/openwrt_shadowsocks_proxy/</link><pubDate>Mon, 07 Feb 2022 13:37:19 +0800</pubDate><guid>https://blog.cuile.com/posts/openwrt_shadowsocks_proxy/</guid><description>
本文记录OpenWrt设置透明代理的步骤及原理。
1. 系统环境 硬件环境：Windows 10 Hyper-V虚拟机，单核处理器，256M内存 固件版本：OpenWrt 19.07.6 r11278-8055e38794 / LuCI openwrt-19.07 branch git-21.101.59933-c56d9f2 shadowsocks-libev：3.3.5 (https://github.com/shadowsocks/openwrt-shadowsocks/releases) luci-app-shadowsocks：2.0.2 v2ray-plugin：4.37.3-20210413 (https://github.com/honwen/openwrt-v2ray-plugin/releases) ChinaDNS：1.3.3 luci-app-chinadns：1.6.2 https-dns-proxy：2021-01-17-5 luci-app-https-dns-proxy：git-21.062.76689-a607f9c-1 luci-i18n-https-dns-proxy-zh-cn：git-21.062.76689-a607f9c-1 2. 运行流程 透明代理的运行原理主要由DNS访问流程、IP访问流程两部分组成组成
2.1 DNS访问流程 graph LR lh((localhost)); dm(Dnsmasq); cd(ChinaDNS); hdp(https-dns-proxy); ss(Shadowsocks); fd(国外DNS); dd(国内DNS); lh -- 1 udp:53 --&amp;gt; dm; dm -- 2 udp:5555 --&amp;gt; cd; cd -- 3.1 udp:5353--&amp;gt; hdp; cd -- 3.2 udp --&amp;gt; dd; hdp -- 4 tcp --&amp;gt; ss; ss -- 5 tcp --&amp;gt; fd; fd -.</description></item><item><title>OpenWRT DNS设置</title><link>https://blog.cuile.com/posts/openwrt_dns/</link><pubDate>Mon, 07 Feb 2022 13:17:39 +0800</pubDate><guid>https://blog.cuile.com/posts/openwrt_dns/</guid><description>
1. 使用自定义域名访问WEB管理界面 网络-DHCP/DNS-常规设置-DNS转发：/openwrt.lan/192.168.xxx.xxx 网络-DHCP/DNS-常规设置-重绑定保护：不勾选 /etc/config/uhttpd-option redirect_https：&amp;lsquo;1&amp;rsquo; 不强制跳转https</description></item><item><title>OpenWRT 启用 ALG 功能</title><link>https://blog.cuile.com/posts/openwrt_ftp_alg/</link><pubDate>Mon, 07 Feb 2022 10:08:02 +0800</pubDate><guid>https://blog.cuile.com/posts/openwrt_ftp_alg/</guid><description>
1. 安装软件包 # opkg install kmod-nf-nathelper-extra # opkg install kmod-nf-ipvs-ftp 2. 添加配置 # nano /etc/sysctl.d/11-nf-conntrack.conf 增加&amp;quot;net.netfilter.nf_conntrack_helper=1&amp;quot;
在使用FTP的主动模式时，要注意关闭网关上的ALG功能（如Windows ALG服务），同时使用可能引起失败
参考文档
原版OpenWRT启用FTP ALG功能 防火墙设置了NAT ALG功能导致FTP数据连接故障</description></item></channel></rss>